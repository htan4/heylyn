define(["jquery"],function(e){function t(){this.cfg={}}return t.prototype={timeSlide:function(t){"use strict";function r(t){e("html, body").animate({scrollTop:t},500)}for(var n=(e.extend(this.cfg,t),function(e){return document.getElementById(e)}),a=function(){return document.body.offsetWidth},o=function(){return document.body.offsetHeight},s={},l=data.length-1;l>=0;l--){var c=new Date(data[l].date),i=c.getFullYear(),f=c.getMonth()+1,u=GetLunarDateString(c);s[i]||(s[i]={}),s[i][f]||(s[i][f]=[]);var p=data[l];p.lunar=u[0]+"<br>&nbsp;&nbsp;&nbsp;"+u[1],p.like_format=p.like<1e4?p.like:(p.like/1e4).toFixed(1)+"万",s[i][f].push(p)}var m=[],h=[],g=n("tpl_scrubber_year").innerHTML.replace(/^\s*/,"").replace(/\s*$/,""),_=n("tpl_scrubber_month").innerHTML.replace(/^\s*/,"").replace(/\s*$/,""),d=n("tpl_content_year").innerHTML.replace(/^\s*/,"").replace(/\s*$/,""),y=n("tpl_content_month").innerHTML.replace(/^\s*/,"").replace(/\s*$/,""),b=n("tpl_content_item").innerHTML.replace(/^\s*/,"").replace(/\s*$/,"");for(i in s){var v=[];for(f in s[i])v.unshift(_.replace(/\{month\}/g,f).replace(/\{year\}/g,i));m.unshift(g.replace(/\{year\}/g,i).replace(/\{list\}/g,v.join("")))}n("scrubber").innerHTML='<a href="javascript:;" class="now">现在</a>'+m.join("")+'<a href="javascript:;" class="birth">出生</a>';for(var i in s){var k=d.replace(/\{year\}/g,i),T=[];for(var f in s[i]){var N=[],w=!0;for(var l in s[i][f]){var H=s[i][f][l],L=b.replace(/\{date\}/g,H.date).replace(/\{lunar\}/g,H.lunar).replace(/\{intro\}/g,H.intro).replace(/\{media\}/g,H.media).replace(/\{like\}/g,H.like).replace(/\{leftOrRight\}/,l%2?"right":"left").replace(/\{isFirst\}/,w?"c_item_first":"").replace(/\{like_format\}/g,H.like_format).replace(/\{comment\}/g,H.comment);N.push(L),w=!1}T.unshift(y.replace(/\{year\}/g,i).replace(/\{month\}/g,f).replace(/\{list\}/g,N.join("")))}k=k.replace(/\{list\}/g,T.join("")),h.unshift(k)}n("content").innerHTML=h.join("")+'<div class="c_year" id="content_month_0_0">出生</div>';var M=function(e,t){for(var r=document.getElementsByClassName("s_year"),n=document.getElementsByClassName("s_month"),a=document.getElementsByClassName(e+"_month"),o=r.length-1;o>=0;o--)r[o].className="s_year";for(var o=n.length-1;o>=0;o--)n[o].style.display="none";for(var o=a.length-1;o>=0;o--)a[o].style.display="block";t.className="s_year cur"},j=function(e,t,r){for(var n=document.getElementsByClassName(e+"_month"),a=n.length-1;a>=0;a--)n[a].className=n[a].className.replace("cur","");r.className=r.className+" cur"},B=function(e){for(var t=n("content").getElementsByClassName("c_year"),r=[],a=0;a<t.length;a++)r.push(t[a].offsetTop);for(var a=1;a<r.length;a++)if(e>r[a-1]&&e<r[a]){var o=t[a-1].innerHTML;return void M(o,n("scrubber_year_"+o))}},E=function(e){for(var t=n("content").getElementsByClassName("c_month"),r=[],a=0;a<t.length;a++)r.push(t[a].offsetTop);for(var a=1;a<=r.length;a++){var o=t[a-1].id.split("_"),s=o[2],l=o[3];a==r.length&&e>r[a-1]?j(s,l,n("scrubber_month_"+s+l)):e>r[a-1]&&e<r[a]&&j(s,l,n("scrubber_month_"+s+l))}};e(".s_year").click(function(){var t=e(this);C(t.html(),this)});var C=function(t,n){M(t,n);var a=e("#content_year_"+t),o=a.offset().top;r(o)};e(".s_month").click(function(){var t=e(this).data("year"),r=e(this).data("month");$(t,r,this)});var $=function(t,n,a){j(t,n,a);var o=e("#content_month_"+t+"_"+n),s=o.offset().top;r(s)};e(".now").click(function(){r(0)}),e(".birth").click(function(){r(o())}),window.onscroll=function(){var e=document.body.scrollTop;e>200?(n("scrubber").style.position="fixed",n("scrubber").style.left=(a()-1080)/2+"px",n("scrubber").style.top="5rem"):(n("scrubber").style.position="",n("scrubber").style.left="",n("scrubber").style.top=""),B(e),E(e)},window.onresize=function(){window.onscroll()}}},{Timeline:t}});